\section{Архитектура на системата}

\input{chapters/construction_architecture.tex}

\subsection{Софтуерна част}

\begin{figure}[htpb!]
    \centering
    \includegraphics[width=1\textwidth]{main_events}
    \caption{Основни събития, касаещи управлението}
    \label{fig:main_events}
\end{figure}


\subsubsection{Модул stdperiph}

За управление на периферията са имплементирани отделни подмодули, всеки от които
е опростен API (Application Programming Interface) за управление на 
интегрираната периферия в микроконтролера. Всеки подмодул е отговорен само и
единсттвено за конкретното интегрирано периферно устройство, за което е създаден.
Интеграцията между периферните подмодули се осъществява отвън.

Подмодулите от този модул са отговорни за инициализиране и управление на
регистрите на интегрираната периферия. 

\subsubsection{Модул CMSIS}

CMSIS е стандарт на ARM за стандартни математически операции.
Той дефинира прототипите на функциите, както и множество
структури от данни за работа с матрици, вектори, тригонометрични и 
други математичски функции.

В проекта е интегрирана модифицирана CMSIS библиотека 
като част от модула за математика.

\subsubsection{Модул math}

Този модул предоставя функции за работа с числа, матрици и полиноми.
Като част от този модул е съставена опростена библиотека за конверсия,
която ще бъде използвана за интегриране с останалите модули.

\subsubsection{Модул control}

Този модул предоставя възможността за лесна инициализация,
конфигуриране и използване на средства за управление.
За момента в модула са имплементирани ПИД регулатор и ограничител.

\subsubsection{Модул специфични за проекта функции}

В този модул са изнесени подмодули и логически смислени наименования на изпълнявани процедури
за удобство и нагледност при писане на софтуера.
Подмодулите, имплементирани в този модул, са подмодул за филлтър на Калман,
подмодул за калибриране и компенсация на сензорни отмествания и други.