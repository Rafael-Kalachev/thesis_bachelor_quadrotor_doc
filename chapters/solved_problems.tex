\section{Изграждане на системата и решени проблеми}

\input{chapters/building_environment.tex}

\subsection{Платка за свързване на компонентите}

Като част от проекта е създадена платка, която осъществява връзката между отделните компоненти.
Платката има за цел също да предотврати проблемите възникващи от използването на хардуер работещ на различни
нива на напрежение. 

Пиновете на микроконтролера са толерантни на 5V напрежение само при режим на логическо четене и изходен режим Open-drain.

5V входовете на приемника са директно свързани с пинове тъй като са толерантни на 5V напрежение.
PA0(TIM5 канал 1), PA3(TIM5 канал 4),
PB0(TIM3 канал 3),  PB1(TIM3 канал 4), 
PB4(TIM3 канал 2), PB5(TIM3 канал 1)

За I2C са използвани пинове PA8 (I2C3 SCL) и PA9 (I2C3 SDA),
които са конфигурирани като Open-drain по спецификация.
Те се свързват със сензорната платка, която има собствени Pull-Up резистори.

Пинове PB6(USART1 TX) и PB7 (USART1 RX) се свързват към
UART към USB устройството, което е конфигурирано за вход и изход (3.3V).

За управление на моторите са използвани пинове PD12 - PD15. 
Тъй като за управлението на моторите са нужни 5V тези пинове са конфигурирани в режим Opne-Drain.
Като за запазване на вътрешните Pull-up резистори на контролера са подбрани \cite{pull_up} 
10\(k\Omega\) резистори.

Захранването се черпи от батерията през един от портовете на ESC контролерите, като останалите не са свързани за да се предотвратят проблеми с захранването.



\begin{figure}[htpb!]
    \centering
    \includegraphics[width=0.7\textwidth]{pcb2}
    \caption{Предна страна на платката}
    \label{fig:pnb_f}
\end{figure}

\begin{figure}[htpb!]
    \centering
    \includegraphics[width=0.7\textwidth]{pcb1}
    \caption{Задна страна на платката}
    \label{fig:pcb_b}
\end{figure}


\input{chapters/mcu_init.tex}
\input{chapters/modeling.tex}